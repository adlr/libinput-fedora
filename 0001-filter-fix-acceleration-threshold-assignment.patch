From 254f87564f485ff44b8426cac3ac7f8efc47e681 Mon Sep 17 00:00:00 2001
From: Peter Hutterer <peter.hutterer@who-t.net>
Date: Tue, 4 Aug 2015 15:08:25 +1000
Subject: [PATCH libinput] filter: fix acceleration threshold assignment
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

The new values were in units/us and didn't make the switch back to ms in
8a6825f1602.

Signed-off-by: Peter Hutterer <peter.hutterer@who-t.net>
Reviewed-by: Jonas Ã…dahl <jadahl@gmail.com>
---
 src/filter.c | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/src/filter.c b/src/filter.c
index 2506ee2..e11d58a 100644
--- a/src/filter.c
+++ b/src/filter.c
@@ -78,6 +78,7 @@ filter_get_speed(struct motion_filter *filter)
  */
 
 #define DEFAULT_THRESHOLD 0.4			/* in units/ms */
+#define MINIMUM_THRESHOLD 0.2			/* in units/ms */
 #define DEFAULT_ACCELERATION 2.0		/* unitless factor */
 #define DEFAULT_INCLINE 1.1			/* unitless factor */
 
@@ -333,9 +334,9 @@ accelerator_set_speed(struct motion_filter *filter,
 	assert(speed >= -1.0 && speed <= 1.0);
 
 	/* delay when accel kicks in */
-	accel_filter->threshold = DEFAULT_THRESHOLD - speed / 4000.0;
-	if (accel_filter->threshold < 0.0002)
-		accel_filter->threshold = 0.0002;
+	accel_filter->threshold = DEFAULT_THRESHOLD - speed / 4.0;
+	if (accel_filter->threshold < MINIMUM_THRESHOLD)
+		accel_filter->threshold = MINIMUM_THRESHOLD;
 
 	/* adjust max accel factor */
 	accel_filter->accel = DEFAULT_ACCELERATION + speed * 1.5;
-- 
2.4.3

